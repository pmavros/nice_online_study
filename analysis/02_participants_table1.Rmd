---
title: "Demographics Report"
author: "Panos Mavros"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    df_print: paged
subtitle: The NICE Project
---

This is an R Markdown Notebook with the analysis of the NICE online study. To run the code below, you can open the file in [RStudio](https://posit.co/products/open-source/rstudio/).


## Load libraries
```{r setup, echo=FALSE, include=TRUE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo=TRUE}
library(furniture) # formating table 1
library(tidyverse) # general wranling
```

## Load data
### Study data
```{r}

folder <- rstudioapi::selectDirectory(
  caption = "Select Directory",
  label = "Select"
)

df <- read.csv(paste0(folder, '/9_analysis/Online Study/data/data_pruned_for_analysis_2023-03-01.csv'))
length(unique(df$Anon_ID))

```

```{r}

names(df)

df %>% 
  filter()
```

## Participant characteristics

This table shows participants' demographic characteristics. It will be transferred to Latex and to the manuscript at a later stage.

Note: "From prolific.co https://researcher-help.prolific.co/hc/en-gb/articles/360019238413-Representative-samples-FAQ:

Starting with the youngest allowable participation age on Prolific, we stratify age using five 9-year brackets: 18-27, 28-37, 38-47, 48-57, and 58+. ‘Sex’ is stratified into male and female. ‘Ethnicity (simplified)’ is stratified into the five categories recommended by the UK Office of National Statistics: White, Mixed, Asian, Black and Other."

```{r}

table_1 <- df  %>% 
  group_by(Anon_ID) %>% 
  slice(1) %>% 
  ungroup() %>% 
  furniture::table1(., splitby = ~ Sex,total = TRUE,
         # Sex,
         Age = Age_breaks,
         Education,
         Ethnicity, 
         "Employment" = Employment, 
         "Upbringing Environment" = `Upbringing_Environment`,
         "Current Environment"= `Current_Environment`,
         "Approval rate" = Approval_rate,
         output = "latex2",
         booktabs = TRUE, caption = "Participant characteristics", label = "tab:participant_characteristics"
        ) 

write(x = table_1, file = "figures/table_1.tex") 

df  %>% 
  group_by(Anon_ID) %>% 
  slice(1) %>% 
  ungroup() %>% 
  furniture::table1(., splitby = ~ Sex,total = TRUE,
         # Sex,
         Age = Age_breaks,
         Education,
         Ethnicity, 
         "Employment" = Employment, 
         "Upbringing Environment" = `Upbringing_Environment`,
         "Current Environment"= `Current_Environment`,
         "Approval rate" = Approval_rate,
         # output = "html",
         booktabs = F, caption = "Participant characteristics", label = "tab:participant_characteristics"
        ) 

```
